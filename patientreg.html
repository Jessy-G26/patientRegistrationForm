<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Patient Registration Portal</title>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <!-- STYLE -->
    <style>
      body {
        background-image: url(photo/bg2.jpg);
        background-repeat: no-repeat;
        background-position: center;
        background-attachment: fixed;
        background-size: cover;
      }
      .container {
        background: rgba(0, 71, 99, 0.7);
      }
      h3 {
        color: lightskyblue;
      }
    </style>
  </head>
  <body>
    <!-- Start Here -->
    <!-- Logout Button -->
    <a
      href="index.html"
      type="button"
      class="btn btn-danger text-white position-absolute top-0 end-0 m-3"
      >Logout</a
    >
    <br />

    <!-- Header -->
    <div class="container mt-5 border border-secondary shadow-lg rounded">
      <h2 class="col-lg-12 pt-4 text-center text-light">
        Welcome to Aventus Hospital
      </h2>
      <h5 class="col-lg-12 text-center text-light">
        Patient Registration Portal
      </h5>
    </div>

    <!-- Start of Patient Info -->
    <div class="container mt-5 pt-3 border border-secondary shadow-lg rounded">
      <form
        action="submission.html"
        class="needs-validation row g-3 p-5 pt-4 text-white"
        method="get"
        onsubmit="return sub()"
        name="patientformRecord"
      >
        <!-- NAME -->
        <h3>Patient Infomation</h3>
        <div class="col-lg-4">
          <label for="fName" class="form-label fw-bold">First Name:</label>
          <input type="text" class="form-control" id="fName" required />
        </div>
        <div class="col-lg-4">
          <label for="mName" class="form-label fw-bold">Middle Name:</label>
          <input type="text" class="form-control" id="mName" required />
        </div>
        <div class="col-lg-4">
          <label for="lName" class="form-label fw-bold">Last Name:</label>
          <input type="text" class="form-control" id="lName" required />
        </div>
        <!-- Address -->
        <div class="col-12">
          <label for="inputAddress" class="form-label fw-bold">Address:</label>
          <input type="text" class="form-control" id="inputAddress" required />
        </div>

        <!-- Birthday -->

        <div class="col-lg-4">
          <label for="bDate" class="form-label fw-bold">Birthdate:</label>
          <input
            type="date"
            class="form-control"
            id="bDate"
            min="1872-01-01"
            max="2022-06-13"
            required
          />
        </div>

        <!-- Contact Number -->
        <div class="col-lg-5">
          <label for="pNum" class="form-label fw-bold">Contact No:</label>
          <input
            type="number"
            class="form-control"
            name="pNum"
            id="contactNumber"
            placeholder="09123456789"
            required
          />
        </div>

        <!-- Gender -->
        <div class="col-lg-3">
          <label for="gender" class="form-label fw-bold">Gender:</label><br />
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="gder"
            value="male"
            required
          />
          Male &nbsp; <br />
          <input
            class="form-check-input col-md-4"
            type="radio"
            name="gender"
            id="gder"
            value="female"
          />
          Female
        </div>

        <!-- Medical History -->
        <div class="col-lg-12 py-2"><hr /></div>
        <h3>Medical Information</h3>
        <div class="col-lg-2">
          <label for="mh" class="form-label fw-bold">Medical History:</label>
        </div>
        <div class="form-check col-lg-2">
          <input
            class="form-check-input"
            type="checkbox"
            value="asthma"
            name="mh"
          />Asthma <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="cancer"
            name="mh"
          />Cancer <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="cardiacDisease"
            name="mh"
          />Cardiac Disease <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="diabetes"
            name="mh"
          />Diabetes <br />
        </div>
        <div class="form-check col-lg-2">
          <input
            class="form-check-input"
            type="checkbox"
            value="hypertension"
            name="mh"
          />Hypertension <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="psychiatricDisorder"
            name="mh"
          />Psychiatric Disorder <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="epilepsy"
            name="mh"
          />Epilepsy <br />
          <input
            class="form-check-input"
            type="checkbox"
            value="others"
            name="mh"
          />Others <br />
        </div>
        <div class="col-lg-2">
          <label for="currentSymptoms" class="form-label fw-bold"
            >Current Symptoms:</label
          >
        </div>

        <!-- Symptoms -->
        <div class="col-lg-4">
          <select id="currentSymptoms" class="form-select" multiple required>
            <option value="Chest Pain">Chest Pain</option>
            <option value="Respiratory">Respiratory</option>
            <option value="Hematological">Hematological</option>
            <option value="Lympathic">Lympathic</option>
            <option value="Neurological">Neurological</option>
            <option value="Psychiatric">Psychiatric</option>
            <option value="Gastrointestinal">Gastrointestinal</option>
            <option value="Weight Loss">Weight Loss</option>
          </select>
        </div>

        <!-- Current Medications -->
        <div class="col-lg-12 pt-4">
          <label for="medications" class="form-label">
            <b>Are you currently taking medications?</b><br />
            <span class="fst-italic"
              >(If yes, please provide what medications you're taking.)</span
            > </label
          ><br />
          <input
            type="radio"
            name="medications"
            value="yes"
            id="meds"
            onclick="medP(this)"
          />
          <label for="yes">Yes</label><br />
          <input
            type="radio"
            name="medications"
            value="no"
            id="meds"
            onclick="medP(this)"
          />
          <label for="no">No</label>
          <input type="text" class="form-control" id="distxt" disabled />
        </div>

        <!-- Submit/Reset Button -->
        <div class="col-lg-12 pt-4 text-center">
          <button type="submit" class="btn btn-primary" id="subForm">
            Submit
          </button>
          <button type="reset" class="btn btn-secondary">Reset</button>
        </div>
      </form>
    </div>
    <br />
    <!-- End of Patient Info -->

    <!-- Patient Submission -->

    <script>
      let patientRecords = localStorage.getItem("patientRecord")
        ? JSON.parse(localStorage.getItem("patientRecord"))
        : [];

      sub = () => {
        var contact = document.getElementById("contactNumber").value;
        if (!/^(09|639)\d{9}$/.test(contact)) {
          alert("Please follow this format: 09123456789");
          return false;
        } else {
          alert("Data successfully recorded");
          addpatientRecord();
          return true;
        }
      };

      // let patientRecords =[];
      function addpatientRecord() {
        const genderChoice = document.querySelectorAll(
          "input[name = 'gender']"
        );
        let gen;
        for (const c of genderChoice) {
          if (c.checked) {
            gen = c.value;
            break;
          }
        }

        const chk = document.querySelectorAll("input[name='mh']:checked");
        let chkValue = [];
        for (const c of chk) {
          if (c.checked) {
            chkValue.push(c.value);
          }
        }

        const currSymptomsChosen = document.getElementById("currentSymptoms");
        const currSymptoms = [...currSymptomsChosen.options]
          .filter((option) => option.selected)
          .map((option) => option.value);

        const takingMeds = document.querySelectorAll(
          "input[name = 'medications']"
        );
        let tm;
        for (const t of takingMeds) {
          if (t.checked) {
            tm = t.value;
            break;
          }
        }
        patientRecords.push(patientRecord);
        console.table(patientRecords);
        localStorage.setItem("patientRecord", JSON.stringify(patientRecords));
      }

      // TAKING MEDICATION VALIDATION
      function medP(medic) {
        var m = document.getElementById("distxt");
        if (medic.value == "yes") {
          m.disabled = false;
        } else if (medic.value == "no") {
          m.disabled = true;
          m.value = null;
        }
      }

      //RESET ALERT BUTTON
      document
        .querySelector("form")
        .addEventListener("reset", function (event) {
          if (!confirm("Are you sure you want to reset the field?")) {
            event.preventDefault();
          } else {
            window.location.reload();
          }
        });
    </script>

    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
